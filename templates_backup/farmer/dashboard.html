<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Farmer Dashboard - Smart Farming Platform</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ¾</text></svg>" />
</head>

<body>

    <div class="dashboard-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-brand">
                <div class="brand-icon">ğŸŒ¾</div>
                <div class="brand-text">
                    <h3>Smart Farming</h3>
                    <span>Farmer Portal</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section-title">Main Menu</div>

                <a th:href="@{/farmer/dashboard}" class="active">
                    <span class="nav-icon">ğŸ </span> Dashboard
                </a>
                <a th:href="@{/farmer/crop-recommendation}">
                    <span class="nav-icon">ğŸŒ±</span> Crop Recommendation
                </a>
                <a th:href="@{/farmer/market-prices}">
                    <span class="nav-icon">ğŸ“ˆ</span> Market Prices
                </a>
                <a th:href="@{/farmer/disease-detection}">
                    <span class="nav-icon">ğŸ”¬</span> Disease Detection
                </a>
                <a th:href="@{/farmer/marketplace}">
                    <span class="nav-icon">ğŸ›’</span> My Marketplace
                </a>
                <a th:href="@{/farmer/schemes}">
                    <span class="nav-icon">ğŸ›ï¸</span> Govt. Schemes
                </a>
                <a th:href="@{/farmer/learning}">
                    <span class="nav-icon">ğŸ“</span> Learning Videos
                </a>

                <div class="nav-section-title">Account</div>
                <a th:href="@{/logout}">
                    <span class="nav-icon">ğŸšª</span> Logout
                </a>
            </nav>

            <div class="sidebar-footer">
                <div style="font-size:11px;color:#6b7280;text-align:center;">
                    Smart Farming Platform v1.0<br />
                    <span style="color:#22c55e;">ğŸŸ¢ System Online</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Nav -->
            <header class="top-nav">
                <div class="top-nav-left">
                    <div class="hamburger" onclick="toggleSidebar()" id="hamburger">
                        <span></span><span></span><span></span>
                    </div>
                    <span class="page-title">ğŸ  Farmer Dashboard</span>
                </div>
                <div class="top-nav-right">
                    <div class="user-info">
                        <div class="user-avatar" th:text="${user.fullName.substring(0,1)}">R</div>
                        <div>
                            <div class="user-name" th:text="${user.fullName}">Ramesh Kumar</div>
                            <div class="user-role">ğŸ‘¨â€ğŸŒ¾ Farmer</div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="page-body">
                <!-- Welcome Banner -->
                <div
                    style="background: linear-gradient(135deg, #0d2515, #1a3824); border: 1px solid rgba(22,163,74,0.2); border-radius: 20px; padding: 28px; margin-bottom: 24px; position: relative; overflow: hidden;">
                    <div style="position: absolute; right: -30px; top: -30px; font-size: 120px; opacity: 0.1;">ğŸŒ¾</div>
                    <h2 style="font-size: 22px; font-weight: 800; color: #f0fdf4; margin-bottom: 6px;">
                        Good Morning, <span style="color: #22c55e;" th:text="${user.fullName}">Ramesh</span>! ğŸŒ…
                    </h2>
                    <p style="color: #86efac; font-size: 14px;">
                        ğŸ“ <span th:text="${user.district}">District</span>, <span th:text="${user.state}">State</span>
                        &nbsp; | &nbsp; ğŸ“… Today: <span id="currentDate"></span>
                    </p>
                </div>

                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-icon">ğŸŒ±</span>
                        <div class="stat-value" th:text="${totalListings}">0</div>
                        <div class="stat-label">My Listings</div>
                    </div>
                    <div class="stat-card blue">
                        <span class="stat-icon">ğŸ“Š</span>
                        <div class="stat-value" th:text="${availableListings}">0</div>
                        <div class="stat-label">Market Available</div>
                    </div>
                    <div class="stat-card amber">
                        <span class="stat-icon">ğŸ”¬</span>
                        <div class="stat-value" th:text="${diseaseQueries}">0</div>
                        <div class="stat-label">Disease Queries</div>
                    </div>
                    <div class="stat-card purple">
                        <span class="stat-icon">ğŸ›ï¸</span>
                        <div class="stat-value" th:text="${recentSchemes.size()}">0</div>
                        <div class="stat-label">Active Schemes</div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card-header">
                        <span class="card-title">âš¡ Quick Actions</span>
                    </div>
                    <div class="card-body">
                        <div class="quick-actions">
                            <a th:href="@{/farmer/crop-recommendation}" class="quick-action-btn">
                                <span class="quick-action-icon">ğŸŒ±</span>
                                <span class="quick-action-label">Crop Advice</span>
                            </a>
                            <a th:href="@{/farmer/market-prices}" class="quick-action-btn">
                                <span class="quick-action-icon">ğŸ“ˆ</span>
                                <span class="quick-action-label">Market Prices</span>
                            </a>
                            <a th:href="@{/farmer/disease-detection}" class="quick-action-btn">
                                <span class="quick-action-icon">ğŸ”¬</span>
                                <span class="quick-action-label">Check Disease</span>
                            </a>
                            <a th:href="@{/farmer/marketplace}" class="quick-action-btn">
                                <span class="quick-action-icon">ğŸ›’</span>
                                <span class="quick-action-label">Sell Crops</span>
                            </a>
                            <a th:href="@{/farmer/schemes}" class="quick-action-btn">
                                <span class="quick-action-icon">ğŸ›ï¸</span>
                                <span class="quick-action-label">Govt Schemes</span>
                            </a>
                            <a th:href="@{/farmer/learning}" class="quick-action-btn">
                                <span class="quick-action-icon">ğŸ“</span>
                                <span class="quick-action-label">Learn Farming</span>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Two Column: Market Prices + Schemes -->
                <div class="grid-2">
                    <!-- Latest Market Prices -->
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">ğŸ“ˆ Latest Market Prices</span>
                            <a th:href="@{/farmer/market-prices}" class="btn btn-secondary btn-sm">View All</a>
                        </div>
                        <div class="card-body" style="padding: 0;">
                            <div class="table-container">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Crop</th>
                                            <th>Market</th>
                                            <th>â‚¹/Quintal</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr th:each="price : ${recentPrices}">
                                            <td><strong th:text="${price.cropName}"></strong></td>
                                            <td style="color:#9ca3af;font-size:12px;" th:text="${price.market}"></td>
                                            <td>
                                                <span style="color:#4ade80;font-weight:700;"
                                                    th:text="'â‚¹' + ${price.modalPrice}"></span>
                                            </td>
                                        </tr>
                                        <tr th:if="${recentPrices.empty}">
                                            <td colspan="3" style="text-align:center;color:#6b7280;padding:20px;">No
                                                prices available</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Active Schemes -->
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">ğŸ›ï¸ Government Schemes</span>
                            <a th:href="@{/farmer/schemes}" class="btn btn-secondary btn-sm">View All</a>
                        </div>
                        <div class="card-body">
                            <div th:if="${recentSchemes.empty}" class="empty-state" style="padding:20px;">
                                <p>No schemes available</p>
                            </div>
                            <div th:each="scheme : ${recentSchemes}"
                                style="padding: 14px; background: var(--surface); border-radius: 12px; margin-bottom: 12px; border: 1px solid var(--border);">
                                <div style="font-size:14px;font-weight:700;color:#f0fdf4;margin-bottom:4px;"
                                    th:text="${scheme.title}"></div>
                                <div style="font-size:12px;color:#9ca3af;margin-bottom:8px;"
                                    th:text="${#strings.abbreviate(scheme.description, 100)}"></div>
                                <span class="badge badge-success" th:text="${scheme.category}"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString('en-IN', {
            weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
        });

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }
    </script>
</body>

</html>